(base) root@dsw-238653-6d97bfd675-6t466:/mnt/workspace/liudong/SandGraph# python demo/social_network_demo.py 
🔥 SandGraph Social Network Demo
============================================================
Steps: 5
Model: mistralai/Mistral-7B-Instruct-v0.2

============================================================
 RL-based LLM Decision Social Network Demo
============================================================

1. Creating LLM Manager with model: mistralai/Mistral-7B-Instruct-v0.2

2. Creating RL Social Network Workflow

3. Executing 5 Social Network Management Steps

--- 第 1 步 ---
================================================================================
Decision 1 - Complete Prompt Content:
================================================================================
You are a social network strategy expert. You MUST respond with EXACTLY 3 lines:

ACTION: [CREATE_POST|ENCOURAGE_INTERACTION|FEATURE_USER|LAUNCH_CAMPAIGN|IMPROVE_ALGORITHM|ADD_FEATURE|MODERATE_CONTENT|EXPAND_NETWORK]
TARGET: [specific target or "N/A"]
REASONING: [brief explanation]

Current State:
- Active Users: 80
- Posts Created: 20
- Content Quality: 0.68
- Network Mood: 0.56
- Crisis Level: 0.01
- Bounce Rate: 0.25

Strategy Guidelines:
- Negative mood → LAUNCH_CAMPAIGN or ENCOURAGE_INTERACTION
- High crisis → MODERATE_CONTENT or LAUNCH_CAMPAIGN  
- Low innovation → ADD_FEATURE or IMPROVE_ALGORITHM
- High controversy → MODERATE_CONTENT
- High bounce rate → IMPROVE_ALGORITHM

Respond with EXACTLY 3 lines in the format above. No other text.
================================================================================
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.75it/s]
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)
LLM Response Status: unknown
LLM Complete Response: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery and content discovery.
🔍 解析响应: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery and content discovery....
✅ 找到ACTION: IMPROVE_ALGORITHM
✅ 找到TARGET: N/A
✅ 找到REASONING: Boost user engagement by optimizing post delivery ...
✅ 解析成功: IMPROVE_ALGORITHM | N/A | Boost user engagement by optim...
Decision: IMPROVE_ALGORITHM
Target: N/A
Reasoning: Boost user engagement by optimizing post delivery and content discovery.
Score: 0.68
Reward: 6.77
Active Users: 80
Engagement Rate: 0.548

--- 第 2 步 ---
================================================================================
Decision 2 - Complete Prompt Content:
================================================================================
You are a social network strategy expert. You MUST respond with EXACTLY 3 lines:

ACTION: [CREATE_POST|ENCOURAGE_INTERACTION|FEATURE_USER|LAUNCH_CAMPAIGN|IMPROVE_ALGORITHM|ADD_FEATURE|MODERATE_CONTENT|EXPAND_NETWORK]
TARGET: [specific target or "N/A"]
REASONING: [brief explanation]

Current State:
- Active Users: 99
- Posts Created: 29
- Content Quality: 0.67
- Network Mood: 0.64
- Crisis Level: 0.00
- Bounce Rate: 0.23

Strategy Guidelines:
- Negative mood → LAUNCH_CAMPAIGN or ENCOURAGE_INTERACTION
- High crisis → MODERATE_CONTENT or LAUNCH_CAMPAIGN  
- Low innovation → ADD_FEATURE or IMPROVE_ALGORITHM
- High controversy → MODERATE_CONTENT
- High bounce rate → IMPROVE_ALGORITHM

Respond with EXACTLY 3 lines in the format above. No other text.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)
LLM Response Status: unknown
LLM Complete Response: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery based on user interests.
🔍 解析响应: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery based on user interests....
✅ 找到ACTION: IMPROVE_ALGORITHM
✅ 找到TARGET: N/A
✅ 找到REASONING: Boost user engagement by optimizing post delivery ...
✅ 解析成功: IMPROVE_ALGORITHM | N/A | Boost user engagement by optim...
Decision: IMPROVE_ALGORITHM
Target: N/A
Reasoning: Boost user engagement by optimizing post delivery based on user interests.
Score: 0.60
Reward: 5.97
Active Users: 99
Engagement Rate: 0.642

--- 第 3 步 ---
================================================================================
Decision 3 - Complete Prompt Content:
================================================================================
You are a social network strategy expert. You MUST respond with EXACTLY 3 lines:

ACTION: [CREATE_POST|ENCOURAGE_INTERACTION|FEATURE_USER|LAUNCH_CAMPAIGN|IMPROVE_ALGORITHM|ADD_FEATURE|MODERATE_CONTENT|EXPAND_NETWORK]
TARGET: [specific target or "N/A"]
REASONING: [brief explanation]

Current State:
- Active Users: 101
- Posts Created: 35
- Content Quality: 0.66
- Network Mood: 0.68
- Crisis Level: 0.00
- Bounce Rate: 0.21

Strategy Guidelines:
- Negative mood → LAUNCH_CAMPAIGN or ENCOURAGE_INTERACTION
- High crisis → MODERATE_CONTENT or LAUNCH_CAMPAIGN  
- Low innovation → ADD_FEATURE or IMPROVE_ALGORITHM
- High controversy → MODERATE_CONTENT
- High bounce rate → IMPROVE_ALGORITHM

Respond with EXACTLY 3 lines in the format above. No other text.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)
LLM Response Status: unknown
LLM Complete Response: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery based on user preferences. Increase content quality and reduce bounce rate.
🔍 解析响应: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery based on user preferences. Increase content quality and reduce bounce rate....
✅ 找到ACTION: IMPROVE_ALGORITHM
✅ 找到TARGET: N/A
✅ 找到REASONING: Boost user engagement by optimizing post delivery ...
✅ 解析成功: IMPROVE_ALGORITHM | N/A | Boost user engagement by optim...
Decision: IMPROVE_ALGORITHM
Target: N/A
Reasoning: Boost user engagement by optimizing post delivery based on user preferences. Increase content quality and reduce bounce rate.
Score: 0.74
Reward: 7.42
Active Users: 101
Engagement Rate: 0.662

--- 第 4 步 ---
================================================================================
Decision 4 - Complete Prompt Content:
================================================================================
You are a social network strategy expert. You MUST respond with EXACTLY 3 lines:

ACTION: [CREATE_POST|ENCOURAGE_INTERACTION|FEATURE_USER|LAUNCH_CAMPAIGN|IMPROVE_ALGORITHM|ADD_FEATURE|MODERATE_CONTENT|EXPAND_NETWORK]
TARGET: [specific target or "N/A"]
REASONING: [brief explanation]

Current State:
- Active Users: 101
- Posts Created: 40
- Content Quality: 0.63
- Network Mood: 0.82
- Crisis Level: 0.00
- Bounce Rate: 0.19

Strategy Guidelines:
- Negative mood → LAUNCH_CAMPAIGN or ENCOURAGE_INTERACTION
- High crisis → MODERATE_CONTENT or LAUNCH_CAMPAIGN  
- Low innovation → ADD_FEATURE or IMPROVE_ALGORITHM
- High controversy → MODERATE_CONTENT
- High bounce rate → IMPROVE_ALGORITHM

Respond with EXACTLY 3 lines in the format above. No other text.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)
LLM Response Status: unknown
LLM Complete Response: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery based on user interests.
🔍 解析响应: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery based on user interests....
✅ 找到ACTION: IMPROVE_ALGORITHM
✅ 找到TARGET: N/A
✅ 找到REASONING: Boost user engagement by optimizing post delivery ...
✅ 解析成功: IMPROVE_ALGORITHM | N/A | Boost user engagement by optim...
Decision: IMPROVE_ALGORITHM
Target: N/A
Reasoning: Boost user engagement by optimizing post delivery based on user interests.
Score: 0.72
Reward: 7.21
Active Users: 101
Engagement Rate: 0.678

--- 第 5 步 ---
================================================================================
Decision 5 - Complete Prompt Content:
================================================================================
You are a social network strategy expert. You MUST respond with EXACTLY 3 lines:

ACTION: [CREATE_POST|ENCOURAGE_INTERACTION|FEATURE_USER|LAUNCH_CAMPAIGN|IMPROVE_ALGORITHM|ADD_FEATURE|MODERATE_CONTENT|EXPAND_NETWORK]
TARGET: [specific target or "N/A"]
REASONING: [brief explanation]

Current State:
- Active Users: 101
- Posts Created: 51
- Content Quality: 0.69
- Network Mood: 0.97
- Crisis Level: 0.01
- Bounce Rate: 0.17

Strategy Guidelines:
- Negative mood → LAUNCH_CAMPAIGN or ENCOURAGE_INTERACTION
- High crisis → MODERATE_CONTENT or LAUNCH_CAMPAIGN  
- Low innovation → ADD_FEATURE or IMPROVE_ALGORITHM
- High controversy → MODERATE_CONTENT
- High bounce rate → IMPROVE_ALGORITHM

Respond with EXACTLY 3 lines in the format above. No other text.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)
LLM Response Status: unknown
LLM Complete Response: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery and content suggestions based on user behavior and preferences.
🔍 解析响应: ACTION: IMPROVE_ALGORITHM
TARGET: N/A
REASONING: Boost user engagement by optimizing post delivery and content suggestions based on user behavior and preferences....
✅ 找到ACTION: IMPROVE_ALGORITHM
✅ 找到TARGET: N/A
✅ 找到REASONING: Boost user engagement by optimizing post delivery ...
✅ 解析成功: IMPROVE_ALGORITHM | N/A | Boost user engagement by optim...
Decision: IMPROVE_ALGORITHM
Target: N/A
Reasoning: Boost user engagement by optimizing post delivery and content suggestions based on user behavior and preferences.
Score: 0.51
Reward: 5.07
Active Users: 101
Engagement Rate: 0.699

============================================================
 Final Results
============================================================
Average Score: 0.65
Average Reward: 6.49
Final Engagement Rate: 0.699
Successful Steps: 5/5

============================================================
 RL Training Statistics
============================================================
Training Steps: 2
Algorithm: ppo
Recent Updates: 2

✅ Demo completed successfully!