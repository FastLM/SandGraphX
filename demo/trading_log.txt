(base) root@dsw-238653-59bcb67999-5kkw2:/mnt/workspace/liudong/SandGraph# python demo/trading_demo.py 

============================================================
 RL-based LLM Decision Trading Demo
============================================================

1. Creating LLM Manager

2. Creating RL Trading Workflow

3. Executing 5 Trading Steps

--- Á¨¨ 1 Ê≠• ---

================================================================================
Decision 1 - Complete Prompt Content:
================================================================================
You are a trading expert in a simulation game.

REQUIRED RESPONSE FORMAT:
ACTION: [BUY|SELL] [SYMBOL] [AMOUNT] shares
REASONING: [brief explanation]

Available Actions:
1. BUY - Purchase stocks
2. SELL - Sell stocks

Available Symbols: AAPL, GOOGL, MSFT, AMZN

Current Market:
AAPL: ‰ª∑Ê†º=146.08, Êàê‰∫§Èáè=7823481
GOOGL: ‰ª∑Ê†º=3159.80, Êàê‰∫§Èáè=8136395
MSFT: ‰ª∑Ê†º=336.47, Êàê‰∫§Èáè=3755854
AMZN: ‰ª∑Ê†º=4499.49, Êàê‰∫§Èáè=4829534

Technical Indicators:
AAPL: MA5=152.24, RSI=33.0, Ë∂ãÂäø=down
GOOGL: MA5=3137.29, RSI=61.3, Ë∂ãÂäø=up
MSFT: MA5=342.57, RSI=26.6, Ë∂ãÂäø=down
AMZN: MA5=4303.01, RSI=82.6, Ë∂ãÂäø=up

Current Portfolio:
Cash: 100000.00
Positions: None


Choose the best trading action to maximize returns. Respond ONLY in the required format above.
================================================================================
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 3/3 [00:02<00:00,  1.08it/s]
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)

LLM Response Status: unknown
LLM Complete Response: ACTION: BUY MSFT 500 shares
REASONING: MSFT is currently undervalued based on its moving average and RSI. The downward trend may reverse, providing an opportunity for potential gains.
üîç Ëß£ÊûêÂìçÂ∫î: ACTION: BUY MSFT 500 shares
REASONING: MSFT is currently undervalued based on its moving average and RSI. The downward trend may reverse, providing an opportunity for potential gains....
‚úÖ ÊâæÂà∞Ê†áÂáÜÊ†ºÂºèACTION: BUY MSFT 500.0
‚úÖ ÊâæÂà∞REASONING: MSFT is currently undervalued based on its moving ...
‚úÖ Ëß£ÊûêÊàêÂäü: BUY MSFT 500.0 | MSFT is currently undervalued ...
LLM Decision: BUY MSFT 500.0
Decision Reason: MSFT is currently undervalued based on its moving average and RSI. The downward trend may reverse, providing an opportunity for potential gains.
Trading Score: 0.000
RL Reward: 0.000
RL Update Status: insufficient_data
Current Cash: 100000.00
Current Positions: {}

--- Á¨¨ 2 Ê≠• ---

================================================================================
Decision 2 - Complete Prompt Content:
================================================================================
You are a trading expert in a simulation game.

REQUIRED RESPONSE FORMAT:
ACTION: [BUY|SELL] [SYMBOL] [AMOUNT] shares
REASONING: [brief explanation]

Available Actions:
1. BUY - Purchase stocks
2. SELL - Sell stocks

Available Symbols: AAPL, GOOGL, MSFT, AMZN

Current Market:
AAPL: ‰ª∑Ê†º=145.08, Êàê‰∫§Èáè=3438247
GOOGL: ‰ª∑Ê†º=3186.00, Êàê‰∫§Èáè=2075992
MSFT: ‰ª∑Ê†º=331.96, Êàê‰∫§Èáè=2947461
AMZN: ‰ª∑Ê†º=4567.17, Êàê‰∫§Èáè=5721731

Technical Indicators:
AAPL: MA5=150.21, RSI=35.4, Ë∂ãÂäø=down
GOOGL: MA5=3151.80, RSI=68.2, Ë∂ãÂäø=up
MSFT: MA5=338.52, RSI=27.3, Ë∂ãÂäø=down
AMZN: MA5=4371.98, RSI=82.2, Ë∂ãÂäø=up

Current Portfolio:
Cash: 100000.00
Positions: None
Recent Decisions:
- Step 1: BUY MSFT - MSFT is currently undervalued ...

Choose the best trading action to maximize returns. Respond ONLY in the required format above.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)

LLM Response Status: unknown
LLM Complete Response: ACTION: BUY AAPL 500 shares
REASONING: AAPL is currently oversold with a RSI of 35.4 and a downward trend. Buying at this price could potentially lead to significant gains as the market recovers.
üîç Ëß£ÊûêÂìçÂ∫î: ACTION: BUY AAPL 500 shares
REASONING: AAPL is currently oversold with a RSI of 35.4 and a downward trend. Buying at this price could potentially lead to significant gains as the market recovers....
‚úÖ ÊâæÂà∞Ê†áÂáÜÊ†ºÂºèACTION: BUY AAPL 500.0
‚úÖ ÊâæÂà∞REASONING: AAPL is currently oversold with a RSI of 35.4 and ...
‚úÖ Ëß£ÊûêÊàêÂäü: BUY AAPL 500.0 | AAPL is currently oversold wit...
LLM Decision: BUY AAPL 500.0
Decision Reason: AAPL is currently oversold with a RSI of 35.4 and a downward trend. Buying at this price could potentially lead to significant gains as the market recovers.
Trading Score: 0.000
RL Reward: 0.000
RL Update Status: insufficient_data
Current Cash: 100000.00
Current Positions: {'AAPL': 500.0}

--- Á¨¨ 3 Ê≠• ---

================================================================================
Decision 3 - Complete Prompt Content:
================================================================================
You are a trading expert in a simulation game.

REQUIRED RESPONSE FORMAT:
ACTION: [BUY|SELL] [SYMBOL] [AMOUNT] shares
REASONING: [brief explanation]

Available Actions:
1. BUY - Purchase stocks
2. SELL - Sell stocks

Available Symbols: AAPL, GOOGL, MSFT, AMZN

Current Market:
AAPL: ‰ª∑Ê†º=142.00, Êàê‰∫§Èáè=3047348
GOOGL: ‰ª∑Ê†º=3205.77, Êàê‰∫§Èáè=3468801
MSFT: ‰ª∑Ê†º=332.03, Êàê‰∫§Èáè=2136515
AMZN: ‰ª∑Ê†º=4686.76, Êàê‰∫§Èáè=6166577

Technical Indicators:
AAPL: MA5=147.60, RSI=37.8, Ë∂ãÂäø=down
GOOGL: MA5=3145.02, RSI=70.1, Ë∂ãÂäø=up
MSFT: MA5=337.66, RSI=17.9, Ë∂ãÂäø=down
AMZN: MA5=4486.50, RSI=82.2, Ë∂ãÂäø=up

Current Portfolio:
Cash: 27460.06
Positions: AAPL: 500.0 ËÇ°
Recent Decisions:
- Step 1: BUY MSFT - MSFT is currently undervalued ...
- Step 2: BUY AAPL - AAPL is currently oversold wit...

Choose the best trading action to maximize returns. Respond ONLY in the required format above.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)

LLM Response Status: unknown
LLM Complete Response: ACTION: BUY AAPL 1000 shares
REASONING: AAPL is currently oversold with a RSI of 37.8 and a down trend, indicating a potential buying opportunity. Additionally, holding MSFT shares and observing a downtrend may suggest a good time to add to the position in a stock that is showing signs of oversold conditions.
üîç Ëß£ÊûêÂìçÂ∫î: ACTION: BUY AAPL 1000 shares
REASONING: AAPL is currently oversold with a RSI of 37.8 and a down trend, indicating a potential buying opportunity. Additionally, holding MSFT shares and observing a dow...
‚úÖ ÊâæÂà∞Ê†áÂáÜÊ†ºÂºèACTION: BUY AAPL 1000.0
‚úÖ ÊâæÂà∞REASONING: AAPL is currently oversold with a RSI of 37.8 and ...
‚úÖ Ëß£ÊûêÊàêÂäü: BUY AAPL 1000.0 | AAPL is currently oversold wit...
LLM Decision: BUY AAPL 1000.0
Decision Reason: AAPL is currently oversold with a RSI of 37.8 and a down trend, indicating a potential buying opportunity. Additionally, holding MSFT shares and observing a downtrend may suggest a good time to add to the position in a stock that is showing signs of oversold conditions.
Trading Score: 0.000
RL Reward: 0.000
RL Update Status: insufficient_data
Current Cash: 27460.06
Current Positions: {'AAPL': 500.0}

--- Á¨¨ 4 Ê≠• ---

================================================================================
Decision 4 - Complete Prompt Content:
================================================================================
You are a trading expert in a simulation game.

REQUIRED RESPONSE FORMAT:
ACTION: [BUY|SELL] [SYMBOL] [AMOUNT] shares
REASONING: [brief explanation]

Available Actions:
1. BUY - Purchase stocks
2. SELL - Sell stocks

Available Symbols: AAPL, GOOGL, MSFT, AMZN

Current Market:
AAPL: ‰ª∑Ê†º=139.81, Êàê‰∫§Èáè=1462390
GOOGL: ‰ª∑Ê†º=3296.46, Êàê‰∫§Èáè=4606366
MSFT: ‰ª∑Ê†º=322.83, Êàê‰∫§Èáè=2342778
AMZN: ‰ª∑Ê†º=4767.95, Êàê‰∫§Èáè=2066064

Technical Indicators:
AAPL: MA5=144.63, RSI=37.5, Ë∂ãÂäø=down
GOOGL: MA5=3188.55, RSI=70.9, Ë∂ãÂäø=up
MSFT: MA5=333.83, RSI=17.8, Ë∂ãÂäø=down
AMZN: MA5=4588.38, RSI=82.4, Ë∂ãÂäø=up

Current Portfolio:
Cash: 27460.06
Positions: AAPL: 500.0 ËÇ°
Recent Decisions:
- Step 1: BUY MSFT - MSFT is currently undervalued ...
- Step 2: BUY AAPL - AAPL is currently oversold wit...
- Step 3: BUY AAPL - AAPL is currently oversold wit...

Choose the best trading action to maximize returns. Respond ONLY in the required format above.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)

LLM Response Status: unknown
LLM Complete Response: ACTION: BUY AMZN 1000 shares
REASONING: AMZN is currently oversold with a RSI of 82.4 and an uptrend. This indicates that it may be due for a pullback, making it a good time to buy. Additionally, its moving average is significantly higher than its current price, suggesting potential for price appreciation.
üîç Ëß£ÊûêÂìçÂ∫î: ACTION: BUY AMZN 1000 shares
REASONING: AMZN is currently oversold with a RSI of 82.4 and an uptrend. This indicates that it may be due for a pullback, making it a good time to buy. Additionally, its ...
‚úÖ ÊâæÂà∞Ê†áÂáÜÊ†ºÂºèACTION: BUY AMZN 1000.0
‚úÖ ÊâæÂà∞REASONING: AMZN is currently oversold with a RSI of 82.4 and ...
‚úÖ Ëß£ÊûêÊàêÂäü: BUY AMZN 1000.0 | AMZN is currently oversold wit...
LLM Decision: BUY AMZN 1000.0
Decision Reason: AMZN is currently oversold with a RSI of 82.4 and an uptrend. This indicates that it may be due for a pullback, making it a good time to buy. Additionally, its moving average is significantly higher than its current price, suggesting potential for price appreciation.
Trading Score: 0.000
RL Reward: 0.000
RL Update Status: insufficient_data
Current Cash: 27460.06
Current Positions: {'AAPL': 500.0}

--- Á¨¨ 5 Ê≠• ---

================================================================================
Decision 5 - Complete Prompt Content:
================================================================================
You are a trading expert in a simulation game.

REQUIRED RESPONSE FORMAT:
ACTION: [BUY|SELL] [SYMBOL] [AMOUNT] shares
REASONING: [brief explanation]

Available Actions:
1. BUY - Purchase stocks
2. SELL - Sell stocks

Available Symbols: AAPL, GOOGL, MSFT, AMZN

Current Market:
AAPL: ‰ª∑Ê†º=138.93, Êàê‰∫§Èáè=3031184
GOOGL: ‰ª∑Ê†º=3349.71, Êàê‰∫§Èáè=8741499
MSFT: ‰ª∑Ê†º=323.05, Êàê‰∫§Èáè=6486678
AMZN: ‰ª∑Ê†º=4875.05, Êàê‰∫§Èáè=2899226

Technical Indicators:
AAPL: MA5=142.38, RSI=43.7, Ë∂ãÂäø=down
GOOGL: MA5=3239.55, RSI=75.5, Ë∂ãÂäø=up
MSFT: MA5=329.27, RSI=18.3, Ë∂ãÂäø=down
AMZN: MA5=4679.28, RSI=82.8, Ë∂ãÂäø=up

Current Portfolio:
Cash: 27460.06
Positions: AAPL: 500.0 ËÇ°
Recent Decisions:
- Step 2: BUY AAPL - AAPL is currently oversold wit...
- Step 3: BUY AAPL - AAPL is currently oversold wit...
- Step 4: BUY AMZN - AMZN is currently oversold wit...

Choose the best trading action to maximize returns. Respond ONLY in the required format above.
================================================================================
Both `max_new_tokens` (=128) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)

LLM Response Status: unknown
LLM Complete Response: ACTION: BUY MSFT 1000 shares
REASONING: MSFT is currently oversold with a low RSI of 18.3 and a downward trend. This indicates that the stock is undervalued and may be a good buy for potential future gains. Additionally, having cash on hand allows for this opportunity to be taken advantage of.
üîç Ëß£ÊûêÂìçÂ∫î: ACTION: BUY MSFT 1000 shares
REASONING: MSFT is currently oversold with a low RSI of 18.3 and a downward trend. This indicates that the stock is undervalued and may be a good buy for potential future ...
‚úÖ ÊâæÂà∞Ê†áÂáÜÊ†ºÂºèACTION: BUY MSFT 1000.0
‚úÖ ÊâæÂà∞REASONING: MSFT is currently oversold with a low RSI of 18.3 ...
‚úÖ Ëß£ÊûêÊàêÂäü: BUY MSFT 1000.0 | MSFT is currently oversold wit...
LLM Decision: BUY MSFT 1000.0
Decision Reason: MSFT is currently oversold with a low RSI of 18.3 and a downward trend. This indicates that the stock is undervalued and may be a good buy for potential future gains. Additionally, having cash on hand allows for this opportunity to be taken advantage of.
Trading Score: 0.000
RL Reward: 0.000
RL Update Status: insufficient_data
Current Cash: 27460.06
Current Positions: {'AAPL': 500.0}

4. Final Results
Total Decisions: 5
Total Reward: 0.000
Average Score: 0.000
RL Training Steps: 0
RL Algorithm: ppo